#-                  - Default: 701
#-
#- NUM_AXES         - Optional: Number of axes to create for this controller
#-                    Default: 1
#-
#- MOVING_POLL      - Optional: Moving poll period (s)
#-                    Default: POLL_PERIOD
#- 
#- IDLE_POLL        - Optional: Idle poll period (s)
#-                    Default: POLL_PERIOD
#-
#- POLL_PERIOD        - Optional: Poll period (s)
#-                    Default: 1.0
#-
#- ###################################################
# ACS MP4U ethernet connection settings
drvAsynIPPortConfigure("$(INSTANCE)_ETH","$(IP_ADDR):$(PORT=701)",0,0,0)
asynOctetSetInputEos( "$(INSTANCE)_ETH", -1, "\r")
asynOctetSetOutputEos("$(INSTANCE)_ETH", -1, "\r")
AcsMotionConfig("$(INSTANCE)", "$(INSTANCE)_ETH", $(NUM_AXES=1), $(MOVING_POLL=$(POLL_PERIOD=1.0)), $(IDLE_POLL=$(POLL_PERIOD=1.0)))
SPiiPlusCreateProfile("$(INSTANCE)", $(MAX_POINTS=2000))
# Load motor records
dbLoadTemplate("substitutions/AcsMotion.substitutions","P=$(PREFIX)")
# Load an asyn record for debugging
dbLoadRecords("$(ASYN)/db/asynRecord.db","P=$(PREFIX),R=asyn_1,PORT=ACS1_ETH,ADDR=0,OMAX=256,IMAX=256")
# Set ERES to EFAC for each axis
doAfterIocInit("dbpf('$(PREFIX)m1.ERES','0.000001')")
doAfterIocInit("dbpf('$(PREFIX)m2.ERES','0.00005')")
doAfterIocInit("dbpf('$(PREFIX)m3.ERES','0.00005')")
doAfterIocInit("dbpf('$(PREFIX)m4.ERES','0.000001')")
doAfterIocInit("dbpf('$(PREFIX)m5.ERES','0.00000002677')")
# Set VMAX
doAfterIocInit("dbpf('$(PREFIX)m1.VMAX','0.7')")
doAfterIocInit("dbpf('$(PREFIX)m2.VMAX','1.0')")
doAfterIocInit("dbpf('$(PREFIX)m3.VMAX','0.6')")
doAfterIocInit("dbpf('$(PREFIX)m4.VMAX','0.05')")
doAfterIocInit("dbpf('$(PREFIX)m5.VMAX','0.0004')")
#- devIocStats
dbLoadRecords("$(DEVIOCSTATS)/db/iocAdminSoft.db","IOC=$(PREFIX)")
#- PV aliases change :: into :
dbLoadRecords("$(TOP)/4idVDCMApp/Db/iocAdminSoft_aliases.db","P=$(PREFIX)")
###############################################################################
iocInit
###############################################################################
# write all the PV names to a local file
dbl > dbl-all.txt
# Diagnostic: CA links in all records
dbcar(0,1)
# print the time our boot was finished
date
exit
